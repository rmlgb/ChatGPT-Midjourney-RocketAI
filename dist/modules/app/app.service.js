'use strict';const _0x2e2a55=_0x3838;(function(_0x54d410,_0x2a5222){const _0x54b818=_0x3838,_0x8cee90=_0x54d410();while(!![]){try{const _0x5e2872=-parseInt(_0x54b818(0xc7))/0x1+-parseInt(_0x54b818(0xa3))/0x2*(-parseInt(_0x54b818(0xdf))/0x3)+parseInt(_0x54b818(0xe6))/0x4*(-parseInt(_0x54b818(0xa9))/0x5)+-parseInt(_0x54b818(0xb2))/0x6+-parseInt(_0x54b818(0x101))/0x7+-parseInt(_0x54b818(0xac))/0x8*(parseInt(_0x54b818(0xd6))/0x9)+parseInt(_0x54b818(0xaf))/0xa*(parseInt(_0x54b818(0xb0))/0xb);if(_0x5e2872===_0x2a5222)break;else _0x8cee90['push'](_0x8cee90['shift']());}catch(_0x511aa0){_0x8cee90['push'](_0x8cee90['shift']());}}}(_0x1015,0x3da7d));var __decorate=this&&this['__decorate']||function(_0x290bd7,_0x1fb0b0,_0x78b2f9,_0x2668d0){const _0x108480=_0x3838;var _0x593ba4=arguments[_0x108480(0xfd)],_0x2f6ddd=_0x593ba4<0x3?_0x1fb0b0:_0x2668d0===null?_0x2668d0=Object['getOwnPropertyDescriptor'](_0x1fb0b0,_0x78b2f9):_0x2668d0,_0x427941;if(typeof Reflect==='object'&&typeof Reflect[_0x108480(0xb7)]===_0x108480(0xbc))_0x2f6ddd=Reflect[_0x108480(0xb7)](_0x290bd7,_0x1fb0b0,_0x78b2f9,_0x2668d0);else{for(var _0x599006=_0x290bd7[_0x108480(0xfd)]-0x1;_0x599006>=0x0;_0x599006--)if(_0x427941=_0x290bd7[_0x599006])_0x2f6ddd=(_0x593ba4<0x3?_0x427941(_0x2f6ddd):_0x593ba4>0x3?_0x427941(_0x1fb0b0,_0x78b2f9,_0x2f6ddd):_0x427941(_0x1fb0b0,_0x78b2f9))||_0x2f6ddd;}return _0x593ba4>0x3&&_0x2f6ddd&&Object[_0x108480(0xb3)](_0x1fb0b0,_0x78b2f9,_0x2f6ddd),_0x2f6ddd;},__metadata=this&&this[_0x2e2a55(0xf2)]||function(_0x3f3e28,_0x14f70c){const _0x3d4b19=_0x2e2a55;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x3d4b19(0xbc))return Reflect[_0x3d4b19(0xbf)](_0x3f3e28,_0x14f70c);},__param=this&&this[_0x2e2a55(0xed)]||function(_0x168799,_0x3d0534){return function(_0x28d994,_0x117e70){_0x3d0534(_0x28d994,_0x117e70,_0x168799);};};Object['defineProperty'](exports,_0x2e2a55(0xaa),{'value':!![]}),exports['AppService']=void 0x0;function _0x3838(_0x3e3b18,_0x446146){const _0x1015ec=_0x1015();return _0x3838=function(_0x383802,_0x1e55a7){_0x383802=_0x383802-0x9d;let _0x21e517=_0x1015ec[_0x383802];return _0x21e517;},_0x3838(_0x3e3b18,_0x446146);}const common_1=require(_0x2e2a55(0xe5)),appCats_entity_1=require(_0x2e2a55(0xc1)),typeorm_1=require(_0x2e2a55(0xb9)),typeorm_2=require(_0x2e2a55(0xf5)),app_entity_1=require(_0x2e2a55(0xcf)),userApps_entity_1=require('./userApps.entity');function _0x1015(){const _0x3d2282=['system','role','isArray','该应用不存在！','appList','401742EgepaJ','AppCatsEntity','您正在操作一个不存在的资源！','Injectable','updateAppCats','该分类名称已存在！','delete','user','appEntity','892785HoAnVE','取消收藏失败！','createAppCat','userId','queryOneCat','map','@nestjs/common','396PkNUAK','substring','AppEntity','该应用名称已存在！','HttpStatus','count','forEach','__param','修改App信息失败！','InjectRepository','DESC','assign','__metadata','body','已将应用加入到我的个人工作台！','@nestjs/typeorm','appId','delMineApp','update','appDes','Like','createApp','gptsSearchAddApp','length','name','修改成功','HttpException','1940750BFBXoZ','includes','save','Repository','find','demoData','修改失败！','appCatsList','2ezYVDk','frontAppList','BAD_REQUEST','catName','删除App失败！','affected','9965zHYvbg','__esModule','coverImg','32WcYWBC','IsNull','UserAppsEntity','15102790RrWzUd','11viGinO','userAppsEntity','2698950wpAWEZ','defineProperty','appCatsEntity','status','该分类不存在！','decorate','修改App信息成功','typeorm','findAndCount','super','function','delApp','isGpts','metadata','应用审核通过','./appCats.entity','auditPass','AppService','findOne','Not','该应用已被用户关联使用中，不可删除！','452399bQaLrG','delAppCat','catId','appRole','preset','design:paramtypes','应用审核拒绝完成','您正在编辑一个不存在的应用！','./app.entity','updateApp'];_0x1015=function(){return _0x3d2282;};return _0x1015();}let AppService=class AppService{constructor(_0x26c7a7,_0x163032,_0x26a6c8){const _0x463aa9=_0x2e2a55;this[_0x463aa9(0xb4)]=_0x26c7a7,this[_0x463aa9(0xde)]=_0x163032,this['userAppsEntity']=_0x26a6c8;}async[_0x2e2a55(0xe1)](_0x42e42f){const _0xd3520a=_0x2e2a55,{name:_0x1c0ba0}=_0x42e42f,_0x27b7cb=await this[_0xd3520a(0xb4)]['findOne']({'where':{'name':_0x1c0ba0}});if(_0x27b7cb)throw new common_1[(_0xd3520a(0x100))](_0xd3520a(0xdb),common_1[_0xd3520a(0xea)][_0xd3520a(0xa5)]);return _0x42e42f[_0xd3520a(0xbe)]=_0x42e42f[_0xd3520a(0xbe)]?0x1:0x0,await this[_0xd3520a(0xb4)][_0xd3520a(0x9d)](_0x42e42f);}async[_0x2e2a55(0xc8)](_0x5fe061){const _0x3928f4=_0x2e2a55,{id:_0x34b3fe}=_0x5fe061,_0x514917=await this[_0x3928f4(0xb4)][_0x3928f4(0xc4)]({'where':{'id':_0x34b3fe}});if(!_0x514917)throw new common_1[(_0x3928f4(0x100))](_0x3928f4(0xb6),common_1[_0x3928f4(0xea)][_0x3928f4(0xa5)]);const _0xd7ab04=await this[_0x3928f4(0xde)][_0x3928f4(0xeb)]({'where':{'catId':_0x34b3fe}});if(_0xd7ab04>0x0)throw new common_1[(_0x3928f4(0x100))]('该分类下存在App，不可删除！',common_1[_0x3928f4(0xea)][_0x3928f4(0xa5)]);const _0x4d01ea=await this[_0x3928f4(0xb4)][_0x3928f4(0xdc)](_0x34b3fe);if(_0x4d01ea[_0x3928f4(0xa8)]>0x0)return'删除成功';throw new common_1[(_0x3928f4(0x100))]('删除失败！',common_1[_0x3928f4(0xea)][_0x3928f4(0xa5)]);}async[_0x2e2a55(0xda)](_0x312f6f){const _0x38bb25=_0x2e2a55,{id:_0x218faa,name:_0x49af1f}=_0x312f6f,_0x4546c2=await this['appCatsEntity'][_0x38bb25(0xc4)]({'where':{'name':_0x49af1f,'id':(0x0,typeorm_1[_0x38bb25(0xc5)])(_0x218faa)}});if(_0x4546c2)throw new common_1[(_0x38bb25(0x100))](_0x38bb25(0xdb),common_1['HttpStatus'][_0x38bb25(0xa5)]);const _0x18b59f=await this[_0x38bb25(0xb4)][_0x38bb25(0xf8)]({'id':_0x218faa},_0x312f6f);if(_0x18b59f['affected']>0x0)return _0x38bb25(0xff);throw new common_1['HttpException']('修改失败！',common_1[_0x38bb25(0xea)][_0x38bb25(0xa5)]);}async[_0x2e2a55(0xe3)](_0x4f868a){const _0x2f30ad=_0x2e2a55,{id:_0xeeff4a}=_0x4f868a;if(!_0xeeff4a)throw new common_1[(_0x2f30ad(0x100))]('缺失必要参数！',common_1[_0x2f30ad(0xea)][_0x2f30ad(0xa5)]);const _0x4a0e8a=await this['appEntity'][_0x2f30ad(0xc4)]({'where':{'id':_0xeeff4a}}),{demoData:_0x203035,coverImg:_0x19a0a6,des:_0x59c606,name:_0x49edeb,isGpts:_0x54b5b9,gptsId:_0x6f0c45}=_0x4a0e8a;return{'demoData':_0x203035?_0x203035['split']('\x0a'):[],'coverImg':_0x19a0a6,'des':_0x59c606,'name':_0x49edeb,'isGpts':_0x54b5b9,'gptsId':_0x6f0c45};}async[_0x2e2a55(0xa2)](_0x109fae){const _0x4f49fd=_0x2e2a55,{page:page=0x1,size:size=0xa,name:_0x469098,status:_0x330828}=_0x109fae,_0x2013f6={};_0x469098&&(_0x2013f6['name']=(0x0,typeorm_1[_0x4f49fd(0xfa)])('%'+_0x469098+'%')),[0x0,0x1,'0','1'][_0x4f49fd(0x102)](_0x330828)&&(_0x2013f6[_0x4f49fd(0xb5)]=_0x330828);const [_0x72054e,_0x1880e5]=await this['appCatsEntity'][_0x4f49fd(0xba)]({'where':_0x2013f6,'order':{'order':_0x4f49fd(0xf0)},'skip':(page-0x1)*size,'take':size}),_0x1cfde5=_0x72054e[_0x4f49fd(0xe4)](_0x295bf8=>_0x295bf8['id']),_0x1a7bb9=await this[_0x4f49fd(0xde)][_0x4f49fd(0x9f)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x1cfde5)}}),_0x20db20={};return _0x1a7bb9[_0x4f49fd(0xec)](_0xf1053c=>{const _0x3b6e7f=_0x4f49fd;_0x20db20[_0xf1053c[_0x3b6e7f(0xc9)]]?_0x20db20[_0xf1053c[_0x3b6e7f(0xc9)]]+=0x1:_0x20db20[_0xf1053c[_0x3b6e7f(0xc9)]]=0x1;}),_0x72054e['forEach'](_0x160250=>_0x160250['appCount']=_0x20db20[_0x160250['id']]||0x0),{'rows':_0x72054e,'count':_0x1880e5};}async[_0x2e2a55(0xd5)](_0x47f9fe,_0x2a0851,_0x368692='id'){const _0x497d0e=_0x2e2a55;var _0x32d378;const {page:page=0x1,size:size=0xa,name:_0x137edb,status:_0x141fac,catId:_0x150747,role:_0xf48c71}=_0x2a0851,_0x27b6b0={};_0x137edb&&(_0x27b6b0[_0x497d0e(0xfe)]=(0x0,typeorm_1[_0x497d0e(0xfa)])('%'+_0x137edb+'%')),_0x150747&&(_0x27b6b0['catId']=_0x150747),_0xf48c71&&(_0x27b6b0[_0x497d0e(0xd2)]=_0xf48c71),_0x141fac&&(_0x27b6b0[_0x497d0e(0xb5)]=_0x141fac);const [_0x1d96c2,_0x193e1d]=await this['appEntity']['findAndCount']({'where':_0x27b6b0,'order':{[_0x368692]:'DESC'},'skip':(page-0x1)*size,'take':size}),_0x358260=_0x1d96c2[_0x497d0e(0xe4)](_0x208904=>_0x208904['catId']),_0x278ccb=await this[_0x497d0e(0xb4)][_0x497d0e(0x9f)]({'where':{'id':(0x0,typeorm_1['In'])(_0x358260)}});return _0x1d96c2[_0x497d0e(0xec)](_0xadb68f=>{const _0x145c8e=_0x497d0e,_0x4064b4=_0x278ccb['find'](_0x110dc6=>_0x110dc6['id']===_0xadb68f[_0x145c8e(0xc9)]);_0xadb68f[_0x145c8e(0xa6)]=_0x4064b4?_0x4064b4[_0x145c8e(0xfe)]:'';}),((_0x32d378=_0x47f9fe===null||_0x47f9fe===void 0x0?void 0x0:_0x47f9fe[_0x497d0e(0xdd)])===null||_0x32d378===void 0x0?void 0x0:_0x32d378['role'])!==_0x497d0e(0xbb)&&_0x1d96c2[_0x497d0e(0xec)](_0x137a21=>{const _0x3fe55f=_0x497d0e;delete _0x137a21[_0x3fe55f(0xcb)];}),{'rows':_0x1d96c2,'count':_0x193e1d};}async[_0x2e2a55(0xa4)](_0x2cb5a7,_0x104203,_0x1b20a4='id',_0x16bae9=[]){const _0x1aa717=_0x2e2a55;var _0x333196;const {page:page=0x1,size:size=0x3e8,name:_0x44858d,catId:_0xe5a9bc,role:_0x46ee0c}=_0x104203,_0x45bbb4=[Object[_0x1aa717(0xf1)]({'status':(0x0,typeorm_1['In'])([0x1,0x4]),'userId':(0x0,typeorm_1[_0x1aa717(0xad)])(),'public':![]},Array['isArray'](_0x16bae9)&&_0x16bae9[_0x1aa717(0xfd)]>0x0?{'gptsId':(0x0,typeorm_1['In'])(_0x16bae9)}:{}),Object[_0x1aa717(0xf1)]({'userId':(0x0,typeorm_1['MoreThan'])(0x0),'public':!![]},Array[_0x1aa717(0xd3)](_0x16bae9)&&_0x16bae9['length']>0x0?{'gptsId':(0x0,typeorm_1['In'])(_0x16bae9)}:{})],[_0x1f1190,_0x47678e]=await this[_0x1aa717(0xde)][_0x1aa717(0xba)]({'where':_0x45bbb4,'order':{'order':_0x1aa717(0xf0)},'skip':(page-0x1)*size,'take':size}),_0x53e5e0=_0x1f1190[_0x1aa717(0xe4)](_0x1f93a2=>_0x1f93a2['catId']),_0x2c09c3=await this[_0x1aa717(0xb4)][_0x1aa717(0x9f)]({'where':{'id':(0x0,typeorm_1['In'])(_0x53e5e0)}});return _0x1f1190[_0x1aa717(0xec)](_0x3e85b5=>{const _0x18ed0e=_0x1aa717,_0x326bd1=_0x2c09c3[_0x18ed0e(0x9f)](_0x1c1866=>_0x1c1866['id']===_0x3e85b5[_0x18ed0e(0xc9)]);_0x3e85b5['catName']=_0x326bd1?_0x326bd1[_0x18ed0e(0xfe)]:'';}),((_0x333196=_0x2cb5a7===null||_0x2cb5a7===void 0x0?void 0x0:_0x2cb5a7[_0x1aa717(0xdd)])===null||_0x333196===void 0x0?void 0x0:_0x333196[_0x1aa717(0xd2)])!=='super'&&_0x1f1190[_0x1aa717(0xec)](_0x3d6b06=>{const _0x5017d6=_0x1aa717;delete _0x3d6b06[_0x5017d6(0xcb)];}),{'rows':_0x1f1190,'count':_0x47678e};}async[_0x2e2a55(0xfb)](_0x435e14){const _0x2354df=_0x2e2a55,{name:_0x3e7312,catId:_0x434740}=_0x435e14;_0x435e14[_0x2354df(0xd2)]=_0x2354df(0xd1);const _0x44450c=await this[_0x2354df(0xde)][_0x2354df(0xc4)]({'where':{'name':_0x3e7312}});if(_0x44450c)throw new common_1['HttpException'](_0x2354df(0xe9),common_1[_0x2354df(0xea)][_0x2354df(0xa5)]);const _0x1db4b0=await this[_0x2354df(0xb4)][_0x2354df(0xc4)]({'where':{'id':_0x434740}});if(!_0x1db4b0)throw new common_1['HttpException']('该分类不存在！',common_1[_0x2354df(0xea)][_0x2354df(0xa5)]);return await this[_0x2354df(0xde)][_0x2354df(0x9d)](_0x435e14);}async['customApp'](_0x58d32f,_0x8f5c){const _0x5224f8=_0x2e2a55,{id:_0x2ec348}=_0x8f5c[_0x5224f8(0xdd)],{name:_0x5d19a2,catId:_0x1fe4d0,des:_0x53a521,preset:_0x33b42f,coverImg:_0x270789,demoData:_0x3cc6b9,public:_0x3c033e,appId:_0xd3c1a2}=_0x58d32f;if(_0xd3c1a2){const _0x14731d=await this['appEntity'][_0x5224f8(0xc4)]({'where':{'id':_0xd3c1a2,'userId':_0x2ec348}});if(!_0x14731d)throw new common_1[(_0x5224f8(0x100))](_0x5224f8(0xce),common_1['HttpStatus']['BAD_REQUEST']);const _0xa40ae1={'name':_0x5d19a2,'catId':_0x1fe4d0,'des':_0x53a521,'preset':_0x33b42f,'coverImg':_0x270789,'demoData':_0x3cc6b9,'public':_0x3c033e,'status':_0x3c033e?0x3:0x1},_0x2af237=await this[_0x5224f8(0xde)][_0x5224f8(0xf8)]({'id':_0xd3c1a2,'userId':_0x2ec348},_0xa40ae1);if(_0x2af237[_0x5224f8(0xa8)])return _0x5224f8(0xff);else throw new common_1['HttpException'](_0x5224f8(0xa1),common_1[_0x5224f8(0xea)]['BAD_REQUEST']);}if(!_0xd3c1a2){const _0x3840a2=await this[_0x5224f8(0xb4)][_0x5224f8(0xc4)]({'where':{'id':_0x1fe4d0}});if(!_0x3840a2)throw new common_1[(_0x5224f8(0x100))](_0x5224f8(0xb6),common_1[_0x5224f8(0xea)][_0x5224f8(0xa5)]);const _0x25279d=await this['appEntity'][_0x5224f8(0xc4)]({'where':{'name':_0x5d19a2}});if(_0x25279d)throw new common_1[(_0x5224f8(0x100))]('该应用名称已存在！',common_1[_0x5224f8(0xea)][_0x5224f8(0xa5)]);const _0x216f8a={'name':_0x5d19a2,'catId':_0x1fe4d0,'des':_0x53a521,'preset':_0x33b42f,'coverImg':_0x270789,'status':_0x3c033e?0x3:0x1,'demoData':_0x3cc6b9,'public':_0x3c033e,'role':_0x5224f8(0xdd),'userId':_0x2ec348},_0x38786d=await this[_0x5224f8(0xde)][_0x5224f8(0x9d)](_0x216f8a),_0xff3126={'appId':_0x38786d['id'],'userId':_0x2ec348,'appType':_0x5224f8(0xdd),'public':_0x3c033e,'status':_0x3c033e?0x3:0x1,'catId':_0x1fe4d0};return this['userAppsEntity']['save'](_0xff3126);}}async[_0x2e2a55(0xd0)](_0x24a499){const _0x21dcfb=_0x2e2a55,{id:_0x527f74,name:_0xa84818,catId:_0x55fb12,status:_0x2e7dba}=_0x24a499,_0x55d0a9=await this[_0x21dcfb(0xde)][_0x21dcfb(0xc4)]({'where':{'name':_0xa84818,'id':(0x0,typeorm_1['Not'])(_0x527f74)}});if(_0x55d0a9)throw new common_1[(_0x21dcfb(0x100))](_0x21dcfb(0xe9),common_1['HttpStatus'][_0x21dcfb(0xa5)]);const _0xa99ecc=await this[_0x21dcfb(0xb4)][_0x21dcfb(0xc4)]({'where':{'id':_0x55fb12}});if(!_0xa99ecc)throw new common_1['HttpException'](_0x21dcfb(0xb6),common_1[_0x21dcfb(0xea)][_0x21dcfb(0xa5)]);const _0x12be49=await this[_0x21dcfb(0xde)][_0x21dcfb(0xc4)]({'where':{'id':_0x527f74}});_0x12be49[_0x21dcfb(0xb5)]!==_0x24a499[_0x21dcfb(0xb5)]&&await this[_0x21dcfb(0xb1)][_0x21dcfb(0xf8)]({'appId':_0x527f74},{'status':_0x2e7dba});_0x24a499[_0x21dcfb(0xbe)]=_0x24a499[_0x21dcfb(0xbe)]?0x1:0x0;const _0x32d692=await this['appEntity']['update']({'id':_0x527f74},_0x24a499);if(_0x32d692[_0x21dcfb(0xa8)]>0x0)return _0x21dcfb(0xb8);throw new common_1['HttpException'](_0x21dcfb(0xee),common_1[_0x21dcfb(0xea)][_0x21dcfb(0xa5)]);}async[_0x2e2a55(0xbd)](_0x1e9b52){const _0x15b5bb=_0x2e2a55,{id:_0x295603}=_0x1e9b52,_0x2fc0d0=await this[_0x15b5bb(0xde)][_0x15b5bb(0xc4)]({'where':{'id':_0x295603}});if(!_0x2fc0d0)throw new common_1[(_0x15b5bb(0x100))]('该应用不存在！',common_1[_0x15b5bb(0xea)][_0x15b5bb(0xa5)]);const _0x520652=await this[_0x15b5bb(0xb1)]['count']({'where':{'appId':_0x295603}});if(_0x520652>0x0)throw new common_1[(_0x15b5bb(0x100))](_0x15b5bb(0xc6),common_1[_0x15b5bb(0xea)][_0x15b5bb(0xa5)]);const _0x24bb30=await this['appEntity'][_0x15b5bb(0xdc)](_0x295603);if(_0x24bb30['affected']>0x0)return'删除App成功';throw new common_1[(_0x15b5bb(0x100))](_0x15b5bb(0xa7),common_1['HttpStatus'][_0x15b5bb(0xa5)]);}async[_0x2e2a55(0xc2)](_0x582877){const _0x465be0=_0x2e2a55,{id:_0x34111c}=_0x582877,_0x3e4f88=await this[_0x465be0(0xde)]['findOne']({'where':{'id':_0x34111c,'status':0x3}});if(!_0x3e4f88)throw new common_1['HttpException'](_0x465be0(0xd4),common_1['HttpStatus'][_0x465be0(0xa5)]);return await this['appEntity'][_0x465be0(0xf8)]({'id':_0x34111c},{'status':0x4}),await this[_0x465be0(0xb1)][_0x465be0(0xf8)]({'appId':_0x34111c},{'status':0x4}),_0x465be0(0xc0);}async['auditFail'](_0x1d4f6c){const _0x147230=_0x2e2a55,{id:_0x41921f}=_0x1d4f6c,_0x1e28e2=await this[_0x147230(0xde)]['findOne']({'where':{'id':_0x41921f,'status':0x3}});if(!_0x1e28e2)throw new common_1[(_0x147230(0x100))](_0x147230(0xd4),common_1[_0x147230(0xea)][_0x147230(0xa5)]);return await this['appEntity'][_0x147230(0xf8)]({'id':_0x41921f},{'status':0x5}),await this[_0x147230(0xb1)][_0x147230(0xf8)]({'appId':_0x41921f},{'status':0x5}),_0x147230(0xcd);}async[_0x2e2a55(0xf7)](_0x57457d,_0x315bb1){const _0x3fb010=_0x2e2a55,{id:_0x56e66a}=_0x57457d,_0x2b7f47=await this[_0x3fb010(0xde)][_0x3fb010(0xc4)]({'where':{'id':_0x56e66a,'userId':_0x315bb1['user']['id']}});if(!_0x2b7f47)throw new common_1['HttpException'](_0x3fb010(0xd8),common_1[_0x3fb010(0xea)]['BAD_REQUEST']);return await this[_0x3fb010(0xde)]['delete'](_0x56e66a),await this[_0x3fb010(0xb1)][_0x3fb010(0xdc)]({'appId':_0x56e66a,'userId':_0x315bb1[_0x3fb010(0xdd)]['id']}),'删除应用成功！';}async['collect'](_0x4869cf,_0x2b4113){const _0x3e7474=_0x2e2a55,{appId:_0x39cae2}=_0x4869cf,{id:_0x389192}=_0x2b4113[_0x3e7474(0xdd)],_0x1e39f1=await this[_0x3e7474(0xb1)][_0x3e7474(0xc4)]({'where':{'appId':_0x39cae2,'userId':_0x389192}});if(_0x1e39f1){const _0x3355d7=await this['userAppsEntity'][_0x3e7474(0xdc)]({'appId':_0x39cae2,'userId':_0x389192});if(_0x3355d7['affected']>0x0)return'取消收藏成功!';else throw new common_1[(_0x3e7474(0x100))](_0x3e7474(0xe0),common_1['HttpStatus'][_0x3e7474(0xa5)]);}const _0x3c6477=await this[_0x3e7474(0xde)]['findOne']({'where':{'id':_0x39cae2}}),{id:_0x179ac5,role:_0x21733f,catId:_0x4dc8a0}=_0x3c6477,_0x5aa6e0={'userId':_0x389192,'appId':_0x179ac5,'catId':_0x4dc8a0,'appRole':_0x21733f,'public':!![],'status':0x1};return await this['userAppsEntity'][_0x3e7474(0x9d)](_0x5aa6e0),_0x3e7474(0xf4);}async['mineApps'](_0x5d7dcc,_0xe42196={'page':0x1,'size':0x1e}){const _0x2ef308=_0x2e2a55,{id:_0x4f18b6}=_0x5d7dcc[_0x2ef308(0xdd)],{page:page=0x1,size:size=0x1e}=_0xe42196,_0x2601aa=await this[_0x2ef308(0xde)][_0x2ef308(0x9f)]({'where':{'status':0x1},'select':['id']}),_0x195fc8=_0x2601aa[_0x2ef308(0xe4)](_0x69f46=>{return _0x69f46['id'];}),[_0x3d03f5,_0x4e28cf]=await this[_0x2ef308(0xb1)][_0x2ef308(0xba)]({'where':{'userId':_0x4f18b6,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5]),'appId':(0x0,typeorm_1['In'])(_0x195fc8)},'order':{'id':'DESC'},'skip':(page-0x1)*size,'take':size}),_0x5d29ed=_0x3d03f5['map'](_0x323bae=>_0x323bae[_0x2ef308(0xf6)]),_0x21c93f=await this[_0x2ef308(0xde)][_0x2ef308(0x9f)]({'where':{'id':(0x0,typeorm_1['In'])(_0x195fc8)}});return _0x3d03f5['forEach'](_0x4eb7ae=>{const _0x347ce7=_0x2ef308,_0x1f7588=_0x21c93f[_0x347ce7(0x9f)](_0x1a72cc=>_0x1a72cc['id']===_0x4eb7ae[_0x347ce7(0xf6)]);_0x4eb7ae['appName']=_0x1f7588?_0x1f7588[_0x347ce7(0xfe)]:'',_0x4eb7ae[_0x347ce7(0xca)]=_0x1f7588?_0x1f7588[_0x347ce7(0xd2)]:'',_0x4eb7ae[_0x347ce7(0xf9)]=_0x1f7588?_0x1f7588['des']:'',_0x4eb7ae[_0x347ce7(0xab)]=_0x1f7588?_0x1f7588['coverImg']:'',_0x4eb7ae[_0x347ce7(0xa0)]=_0x1f7588?_0x1f7588[_0x347ce7(0xa0)]:'',_0x4eb7ae[_0x347ce7(0xcb)]=_0x1f7588[_0x347ce7(0xe2)]===_0x4f18b6?_0x1f7588[_0x347ce7(0xcb)]:'******';}),{'rows':_0x3d03f5,'count':_0x4e28cf};}async[_0x2e2a55(0xfc)](_0xefa34a,_0x14f13c){const _0x242a68=_0x2e2a55,{id:_0x1f243a,title:_0x38a278,link:_0x453bb8,description:_0x196f6b,favicon:_0x15c99e}=_0xefa34a[_0x242a68(0xf3)],_0x5267ed=await this['appEntity'][_0x242a68(0xc4)]({'where':[{'gptsId':_0x1f243a},{'name':_0x38a278}]});if(!_0x5267ed){const _0x305409=_0x196f6b['length']>0xff?_0x196f6b[_0x242a68(0xe7)](0x0,0xff):_0x196f6b,_0x3d4b7a={'name':_0x38a278,'des':_0x305409,'coverImg':_0x15c99e,'order':0x3e8,'status':0x1,'demoData':'','role':_0x242a68(0xd1),'public':![],'isGpts':0x1,'gptsId':_0x1f243a,'catId':0x1,'preset':''},_0x216834=await this['appEntity']['save'](_0x3d4b7a);return _0x216834;}else return _0x5267ed;}};AppService=__decorate([(0x0,common_1[_0x2e2a55(0xd9)])(),__param(0x0,(0x0,typeorm_2['InjectRepository'])(appCats_entity_1[_0x2e2a55(0xd7)])),__param(0x1,(0x0,typeorm_2[_0x2e2a55(0xef)])(app_entity_1[_0x2e2a55(0xe8)])),__param(0x2,(0x0,typeorm_2['InjectRepository'])(userApps_entity_1[_0x2e2a55(0xae)])),__metadata(_0x2e2a55(0xcc),[typeorm_1['Repository'],typeorm_1[_0x2e2a55(0x9e)],typeorm_1[_0x2e2a55(0x9e)]])],AppService),exports[_0x2e2a55(0xc3)]=AppService;