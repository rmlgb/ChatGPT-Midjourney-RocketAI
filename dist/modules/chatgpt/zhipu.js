'use strict';const _0x499287=_0x5b8d;(function(_0x117649,_0x15c610){const _0x532cfc=_0x5b8d,_0x29285a=_0x117649();while(!![]){try{const _0x175faf=-parseInt(_0x532cfc(0x1a2))/0x1*(-parseInt(_0x532cfc(0x1ab))/0x2)+-parseInt(_0x532cfc(0x1ba))/0x3*(-parseInt(_0x532cfc(0x1b1))/0x4)+-parseInt(_0x532cfc(0x1b3))/0x5+-parseInt(_0x532cfc(0x1bf))/0x6+-parseInt(_0x532cfc(0x19b))/0x7*(-parseInt(_0x532cfc(0x1a1))/0x8)+parseInt(_0x532cfc(0x1a5))/0x9*(-parseInt(_0x532cfc(0x1aa))/0xa)+-parseInt(_0x532cfc(0x1a9))/0xb*(-parseInt(_0x532cfc(0x19e))/0xc);if(_0x175faf===_0x15c610)break;else _0x29285a['push'](_0x29285a['shift']());}catch(_0x51de5b){_0x29285a['push'](_0x29285a['shift']());}}}(_0x3b14,0x7746c));function _0x5b8d(_0x1caa20,_0x24ed08){const _0x3b1450=_0x3b14();return _0x5b8d=function(_0x5b8dc9,_0x2e7567){_0x5b8dc9=_0x5b8dc9-0x194;let _0x212986=_0x3b1450[_0x5b8dc9];return _0x212986;},_0x5b8d(_0x1caa20,_0x24ed08);}Object[_0x499287(0x194)](exports,'__esModule',{'value':!![]}),exports[_0x499287(0x197)]=exports[_0x499287(0x199)]=exports[_0x499287(0x1b8)]=exports[_0x499287(0x196)]=void 0x0;const axios=require(_0x499287(0x1a7)),jwt=require(_0x499287(0x1b6));function generateToken(_0x2911c9,_0x337bb9=0x3e8*0x3c*0x3c*0x18*0x168){const _0x1e4810=_0x499287,[_0xa8828a,_0x31abc1]=_0x2911c9[_0x1e4810(0x198)]('.'),_0xf1a456={'api_key':_0xa8828a,'exp':Math[_0x1e4810(0x19a)](Date[_0x1e4810(0x19c)]())+_0x337bb9*0x3e8,'timestamp':Math[_0x1e4810(0x19a)](Date[_0x1e4810(0x19c)]())};return jwt[_0x1e4810(0x1af)](_0xf1a456,_0x31abc1,{'algorithm':'HS256','header':{'alg':_0x1e4810(0x1a4),'sign_type':'SIGN'}});}exports[_0x499287(0x196)]=generateToken;function _0x3b14(){const _0x36a33e=['id:','3367216jYdpFA','8fVpkup','meta:','HS256','32742tXGWuc','data','axios','parse','33OXZaIy','1830LcRVrr','108530eQLCtH','stream','application/json','length','sign','end','1069516qtzADz','/sse-invoke','679630FNdTvh','trim','replace','jsonwebtoken','usage','compilerMetaJsonStr','filter','3TYAbpW','is_end','error','error:\x20','https://open.bigmodel.cn/api/paas/v3/model-api/','883764sMRfmB','defineProperty','catch','generateToken','sendMessageFromZhipu','split','compilerStream','round','7KKvdXB','now','data:','1260516TLDxEL','event:'];_0x3b14=function(){return _0x36a33e;};return _0x3b14();}function compilerMetaJsonStr(_0x43cfd1){const _0x8115d2=_0x499287;let _0xb0d467={};try{_0xb0d467=JSON[_0x8115d2(0x1a8)](_0x43cfd1);}catch(_0xedaec8){_0xb0d467={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x8115d2(0x1bc)]('json\x20parse\x20error\x20from\x20zhipu!',_0x43cfd1);}return _0xb0d467;}exports[_0x499287(0x1b8)]=compilerMetaJsonStr;function compilerStream(_0x1cb368){const _0x2044ed=_0x499287;var _0x55eff4;if(_0x1cb368[_0x2044ed(0x1ae)]===0x3)return{'event':_0x1cb368[0x0][_0x2044ed(0x1b5)](_0x2044ed(0x19f),''),'id':_0x1cb368[0x1]['replace']('id:',''),'is_end':![],'result':_0x1cb368[0x2][_0x2044ed(0x1b5)](_0x2044ed(0x19d),'')[_0x2044ed(0x1b4)]()};if(_0x1cb368['length']===0x4)return{'event':_0x1cb368[0x0]['replace']('event:',''),'id':_0x1cb368[0x1][_0x2044ed(0x1b5)](_0x2044ed(0x1a0),''),'result':_0x1cb368[0x2]['replace'](_0x2044ed(0x19d),'')[_0x2044ed(0x1b4)](),'is_end':!![],'usage':(_0x55eff4=compilerMetaJsonStr(_0x1cb368[0x3][_0x2044ed(0x1b5)](_0x2044ed(0x1a3),'')))===null||_0x55eff4===void 0x0?void 0x0:_0x55eff4[_0x2044ed(0x1b7)]};}exports[_0x499287(0x199)]=compilerStream;async function sendMessageFromZhipu(_0x11d7bd,{onProgress:_0x4cc3b5,key:_0x24402c,model:_0x2a456a,temperature:temperature=0.95}){const _0x1cee0a=await generateToken(_0x24402c);return new Promise((_0x386f0e,_0x8b452e)=>{const _0x1e692f=_0x5b8d,_0x51bbe1=_0x1e692f(0x1be)+_0x2a456a+_0x1e692f(0x1b2),_0x44a68f={'method':'POST','url':_0x51bbe1,'responseType':_0x1e692f(0x1ac),'headers':{'Content-Type':_0x1e692f(0x1ad),'Authorization':_0x1cee0a},'data':{'prompt':_0x11d7bd,'temperature':temperature}};axios(_0x44a68f)['then'](_0x2a01f8=>{const _0x2ee7b9=_0x1e692f,_0x591c45=_0x2a01f8[_0x2ee7b9(0x1a6)];let _0x2474a9,_0x1e3e2d='';_0x591c45['on'](_0x2ee7b9(0x1a6),_0x4a5058=>{const _0x407afd=_0x2ee7b9,_0x2059d5=_0x4a5058['toString']()[_0x407afd(0x198)]('\x0a')[_0x407afd(0x1b9)](_0x102d90=>_0x102d90[_0x407afd(0x1b4)]()!==''),_0x14b9e4=compilerStream(_0x2059d5);if(!_0x14b9e4)return;const {id:_0x7845ea,result:_0x4030b1,is_end:_0x5be416}=_0x14b9e4;_0x4030b1&&(_0x1e3e2d+=_0x4030b1[_0x407afd(0x1b4)]()),_0x5be416&&(_0x14b9e4[_0x407afd(0x1bb)]=![],_0x2474a9=_0x14b9e4,_0x2474a9['text']=_0x1e3e2d),_0x4cc3b5(_0x14b9e4);}),_0x591c45['on'](_0x2ee7b9(0x1b0),()=>{_0x386f0e(_0x2474a9),_0x1e3e2d='';});})[_0x1e692f(0x195)](_0x565fa6=>{const _0x209cf4=_0x1e692f;console['log'](_0x209cf4(0x1bd),_0x565fa6);});});}exports['sendMessageFromZhipu']=sendMessageFromZhipu;