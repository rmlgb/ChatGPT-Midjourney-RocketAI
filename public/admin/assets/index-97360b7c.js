import{d as x,r as U,c as n,o,e as g,h as t,i as d,L as w,f as c,a0 as u,m as y,F as p,w as E,v as I,g as m,E as v,_ as L,q as _}from"./index-a2cde0ca.js";const D={class:"upload-container"},R={key:1,class:"image"},q={key:0,class:"mask"},A={class:"actions"},F={key:0,class:"el-upload__tip"},P={style:{display:"inline-block"}},T=x({name:"ImageUpload"}),G=x({...T,props:{action:{type:String,default:"/api/upload/file"},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:String,default:""},size:{type:Number,default:5},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","onSuccess"],setup(e,{emit:$}){const h=e,f=$,a=U({imageViewerVisible:!1,progress:{preview:"",percent:0}});function b(){a.value.imageViewerVisible=!0}function k(){a.value.imageViewerVisible=!1}function V(){f("update:url","")}const S=i=>{const r=i.name.split(".").at(-1),l=h.ext.includes(r),s=i.size/1024/1024<h.size;return l||v.error(`上传图片只支持 ${h.ext.join(" / ")} 格式！`),s||v.error(`上传图片大小不能超过 ${h.size}MB！`),l&&s&&(a.value.progress.preview=URL.createObjectURL(i)),l&&s},z=i=>{a.value.progress.percent=~~i.percent},C=i=>{a.value.progress.preview="",a.value.progress.percent=0,f("onSuccess",i),f("update:url",i.data)};return(i,N)=>{const r=L,l=n("el-icon"),s=n("el-image"),B=n("el-progress"),j=n("el-upload"),M=n("el-alert"),O=n("el-image-viewer");return o(),g("div",D,[t(j,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":S,"on-progress":z,"on-success":C,drag:"",class:"image-upload"},{default:d(()=>[e.url&&e.url!=""?(o(),w(s,{key:0,src:e.url===""?e.placeholder:e.url,style:u(`width:${e.width}px;height:${e.height}px;`)},{error:d(()=>[c("div",{class:"image-slot",style:u(`width:${e.width}px;height:${e.height}px;`)},[t(l,null,{default:d(()=>[t(r,{name:"ep:plus"})]),_:1})],4)]),_:1},8,["src","style"])):(o(),g("div",R,[t(s,{src:e.url,style:u(`width:${e.width}px;height:${e.height}px;`)},null,8,["src","style"]),e.url&&e.url!=""?(o(),g("div",q,[c("div",A,[c("span",{title:"预览",onClick:y(b,["stop"])},[t(l,null,{default:d(()=>[t(r,{name:"ep:zoom-in"})]),_:1})]),c("span",{title:"移除",onClick:y(V,["stop"])},[t(l,null,{default:d(()=>[t(r,{name:"ep:delete"})]),_:1})])])])):p("",!0)])),E(c("div",{class:"progress",style:u(`width:${e.width}px;height:${e.height}px;`)},[t(s,{src:m(a).progress.preview,style:u(`width:${e.width}px;height:${e.height}px;`)},null,8,["src","style"]),t(B,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:m(a).progress.percent},null,8,["width","percentage"])],4),[[I,e.url===""&&m(a).progress.percent]])]),_:1},8,["headers","action","data","name"]),e.notip?p("",!0):(o(),g("div",F,[c("div",P,[t(M,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"success","show-icon":"",closable:!1},null,8,["title"])])])),m(a).imageViewerVisible?(o(),w(O,{key:1,"url-list":[e.url],teleported:"",onClose:k},null,8,["url-list"])):p("",!0)])}}});const J=_(G,[["__scopeId","data-v-1b8004e8"]]);export{J as I};
