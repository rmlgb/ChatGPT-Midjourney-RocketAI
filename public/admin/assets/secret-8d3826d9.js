import{d as E,r as i,O as L,y as j,c as l,o as u,e as g,h as a,i as e,f,l as d,J as A,K as F,L as v,F as M,P as k,E as V,s as b}from"./index-a2cde0ca.js";const R={class:"flex justify-between"},$=f("b",null,"key池管理",-1),D={class:"flex justify-between",style:{width:"100%"}},I=E({__name:"secret",setup(J){const o=i([]),_=L({chatGptKey:[]});i({chatGptKey:[{required:!0,trigger:"blur",message:"请填写您的chatGpt的key"}]});const p=i();async function m(){const t=await k.queryGptKeys();o.value=t.data.map(n=>({configKey:n.configKey,configVal:n.configVal,status:n.status})),t.data.length===0&&y(),_.chatGptKey=o.value}function y(){o.value.push({configKey:"",configVal:"",status:1})}function x(t){o.value.splice(t,1)}function K(){var t;(t=p.value)==null||t.validate(async n=>{if(n){try{await k.setGptKeys({configs:o.value}),V.success("变更配置信息成功")}catch{}m()}else V.error("请填写完整信息")})}return j(()=>{m()}),(t,n)=>{const c=l("el-button"),w=l("el-input"),C=l("el-switch"),G=l("el-form-item"),U=l("el-col"),B=l("el-row"),N=l("el-form"),q=l("el-card");return u(),g("div",null,[a(q,{style:{margin:"20px"}},{header:e(()=>[f("div",R,[$,a(c,{class:"button",text:"",onClick:K},{default:e(()=>[d(" 保存设置 ")]),_:1})])]),default:e(()=>[a(N,{ref_key:"formRef",ref:p,model:_,"label-width":"80px"},{default:e(()=>[a(B,null,{default:e(()=>[a(U,{xs:24,md:21,lg:16,xl:13},{default:e(()=>[(u(!0),g(A,null,F(o.value,(s,h)=>(u(),v(G,{key:s.configKey,label:`key-${h+1}`,prop:"chatGptKey"},{default:e(()=>[f("div",D,[a(w,{modelValue:s.configVal,"onUpdate:modelValue":r=>s.configVal=r,placeholder:"请填写您的ChatGpt-Key",clearable:"",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),o.value.length!==1?(u(),v(c,{key:0,type:"danger",plain:"",class:"ml-1",onClick:r=>x(h)},{default:e(()=>[d(" 删除 ")]),_:2},1032,["onClick"])):M("",!0),a(C,{modelValue:s.status,"onUpdate:modelValue":r=>s.status=r,class:"ml-5","active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),a(c,{class:"mt-5",style:{"margin-left":"80px"},onClick:y},{default:e(()=>[d(" 添加key ")]),_:1})]),_:1},8,["model"])]),_:1})])}}});typeof b=="function"&&b(I);export{I as default};
