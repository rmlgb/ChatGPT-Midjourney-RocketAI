import{d as P,r as _,O as V,y as Q,c as n,Q as T,o as z,e as G,h as e,i as a,l as r,g,w as H,L as J,f as K,t as w,M as W,E as X,z as Y,s as x}from"./index-a2cde0ca.js";import{A as I}from"./sales-35c723a2.js";const Z=["src"],E=P({__name:"salesUser",setup(ee){const C=_(),N=_(0),b=_(!1),m=_(!1),U=_(),i=V({performanceRatio:0,salesOutletName:"",userId:0}),s=V({salesOutletName:"",performanceRatio:null,page:1,size:10}),A=V({performanceRatio:[{required:!0,message:"请填写佣金比例",trigger:"blur"}],salesOutletName:[{required:!0,message:"请填写自定义分销名称",trigger:"blur"}]}),h=_([]);async function c(){try{b.value=!0;const o=await I.querySalesUserList(s);b.value=!1;const{rows:l,count:d}=o.data;N.value=d,h.value=l}catch{b.value=!1}}function S(o){o==null||o.resetFields(),c()}async function B(o){o==null||o.validate(async l=>{l&&(await I.updateSalesUser(i),X.success("修改信息成功！"),m.value=!1,c())})}async function M(o){const{userId:l,performanceRatio:d,salesOutletName:p}=o;i.performanceRatio=d,i.salesOutletName=p,m.value=!0,i.userId=l}return Q(()=>{c()}),(o,l)=>{const d=n("el-input"),p=n("el-form-item"),y=n("el-button"),k=n("el-form"),v=Y,q=n("el-alert"),u=n("el-table-column"),f=n("el-tag"),D=n("el-table"),$=n("el-pagination"),L=n("el-row"),j=n("el-dialog"),F=T("loading");return z(),G("div",null,[e(v,null,{default:a(()=>[e(k,{ref_key:"formRef",ref:C,inline:!0,model:s},{default:a(()=>[e(p,{label:"分销人代号",prop:"salesOutletName"},{default:a(()=>[e(d,{modelValue:s.salesOutletName,"onUpdate:modelValue":l[0]||(l[0]=t=>s.salesOutletName=t),placeholder:"填写分销人代号搜索"},null,8,["modelValue"])]),_:1}),e(p,{label:"返佣比例",prop:"performanceRatio"},{default:a(()=>[e(d,{modelValue:s.performanceRatio,"onUpdate:modelValue":l[1]||(l[1]=t=>s.performanceRatio=t),placeholder:"填写分销人返佣比例"},null,8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(y,{type:"primary",onClick:c},{default:a(()=>[r(" 查询 ")]),_:1}),e(y,{onClick:l[2]||(l[2]=t=>S(g(C)))},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(v,null,{default:a(()=>[e(q,{"show-icon":"",title:"佣金账户设置说明",description:"佣金设置实时生效、佣金比例用户用户邀请的成员下单后的结算比例、分销人代号会在分销页面展示！",type:"success"})]),_:1}),e(v,{style:{width:"100%"}},{default:a(()=>[H((z(),J(D,{border:"",data:g(h),style:{width:"100%"},size:"large"},{default:a(()=>[e(u,{prop:"userInfo.avatar",label:"头像",width:"120"},{default:a(t=>{var R,O;return[K("img",{src:(O=(R=t.row)==null?void 0:R.userInfo)==null?void 0:O.avatar,style:{height:"50px"}},null,8,Z)]}),_:1}),e(u,{prop:"userInfo.email",label:"邮箱",width:"200"}),e(u,{prop:"salesOutletName",label:"分销人代号",width:"120"}),e(u,{prop:"performanceRatio",label:"分销人佣金比例",align:"center"},{default:a(t=>[e(f,null,{default:a(()=>[r(w(t.row.performanceRatio)+"% ",1)]),_:2},1024)]),_:1}),e(u,{prop:"orderCount",label:"累计分销订单量",align:"center"},{default:a(t=>[e(f,{type:"success"},{default:a(()=>[r(w(t.row.orderCount),1)]),_:2},1024)]),_:1}),e(u,{prop:"totalAmount",label:"分销人账户总金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.totalAmount>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(t.row.totalAmount),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"withdrawalAmount",label:"分销人已提现金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.withdrawalAmount>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(t.row.withdrawalAmount),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"distributionBalance",label:"分销人可提现金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.distributionBalance>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(t.row.distributionBalance),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"drawMoneyIn",label:"分销人正在提现金额",align:"center"},{default:a(t=>[e(f,{type:t.row.drawMoneyIn>0?"success":"danger"},{default:a(()=>[r(" ￥"+w(t.row.drawMoneyIn),1)]),_:2},1032,["type"])]),_:1}),e(u,{fixed:"right",label:"操作",width:"100",align:"center"},{default:a(t=>[e(y,{link:"",type:"primary",size:"small",onClick:R=>M(t.row)},{default:a(()=>[r(" 变更用户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,g(b)]]),e(L,{class:"flex justify-end mt-5"},{default:a(()=>[e($,{"current-page":s.page,"onUpdate:currentPage":l[3]||(l[3]=t=>s.page=t),"page-size":s.size,"onUpdate:pageSize":l[4]||(l[4]=t=>s.size=t),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:g(N),onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(j,{modelValue:g(m),"onUpdate:modelValue":l[9]||(l[9]=t=>W(m)?m.value=t:null),title:"修改用户权限",width:"450px"},{footer:a(()=>[e(y,{onClick:l[7]||(l[7]=t=>m.value=!1)},{default:a(()=>[r(" 我再想想 ")]),_:1}),e(y,{type:"primary",onClick:l[8]||(l[8]=t=>B(g(U)))},{default:a(()=>[r(" 确认修改 ")]),_:1})]),default:a(()=>[e(k,{ref_key:"cramiRef",ref:U,model:i,rules:A,"label-width":"105px"},{default:a(()=>[e(p,{label:"佣金比例",prop:"performanceRatio"},{default:a(()=>[e(d,{modelValue:i.performanceRatio,"onUpdate:modelValue":l[5]||(l[5]=t=>i.performanceRatio=t),modelModifiers:{number:!0},type:"number",placeholder:"设置佣金比例"},null,8,["modelValue"])]),_:1}),e(p,{label:"自定义名称",prop:"salesOutletName"},{default:a(()=>[e(d,{modelValue:i.salesOutletName,"onUpdate:modelValue":l[6]||(l[6]=t=>i.salesOutletName=t),placeholder:"设置自定义名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});typeof x=="function"&&x(E);export{E as default};
