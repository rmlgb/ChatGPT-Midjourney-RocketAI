import{d as O,O as D,r as m,y as j,c as o,o as _,e as M,h as e,i as a,f as U,l as g,J as B,K as E,t as J,P as b,E as x,z as L,s as V}from"./index-a2cde0ca.js";const z={class:"flex justify-between"},K=U("b",null,"码支付参数设置",-1),F=O({__name:"mpay",setup(T){const t=D({payMpayStatus:"",payMpayPid:"",payMpaySecret:"",payMpayNotifyUrl:"",payMpayReturnUrl:"",payMpayApiPayUrl:"",payMpayRedirect:"",payMpayChannel:[]}),h=m({payMpayStatus:[{required:!0,trigger:"change",message:"请选择当前支付开启状态"}],payMpaySecret:[{required:!0,trigger:"blur",message:"请填写支付秘钥"}],payMpayPid:[{required:!0,trigger:"blur",message:"请填写商户PID"}],payMpayNotifyUrl:[{required:!0,trigger:"blur",message:"请填写支付通知地址"}],payMpayApiPayUrl:[{required:!0,trigger:"blur",message:"请填写平台支付API请求地址"}]}),d=m(),C=[{label:"微信支付",value:"wxpay"},{label:"支付宝支付",value:"alipay"}];async function i(){const n=await b.queryConfig({keys:["payMpaySecret","payMpayNotifyUrl","payMpayReturnUrl","payMpayPid","payMpayStatus","payMpayApiPayUrl","payMpayRedirect","payMpayChannel"]}),l=n.data.payMpayChannel?JSON.parse(n.data.payMpayChannel):[];Object.assign(t,n.data,{payMpayChannel:l})}function P(){var n;(n=d.value)==null||n.validate(async l=>{if(l){try{await b.setConfig({settings:v(t)}),x.success("变更配置信息成功")}catch{}i()}else x.error("请填写完整信息")})}function S(n,l){if(["payMpayChannel"].includes(n)){if(!l)return[];if(l)return JSON.stringify(l)}else return l}function v(n){return Object.keys(n).map(l=>({configKey:l,configVal:S(l,n[l])}))}return j(()=>{i()}),(n,l)=>{const c=o("el-alert"),w=L,k=o("el-button"),N=o("el-switch"),r=o("el-form-item"),u=o("el-col"),y=o("el-row"),s=o("el-input"),f=o("el-divider"),A=o("el-checkbox"),R=o("el-checkbox-group"),q=o("el-form"),I=o("el-card");return _(),M("div",null,[e(w,null,{default:a(()=>[e(c,{closable:!1,"show-icon":"",title:"码支付参数说明",description:"码支付只能支持跳转登录、可同时开通多渠道、同时开启多种支付方式的情况优先级参照支付菜单排序、同时只能使用一种平台、所有的支付通知地址统一为 https://域名/api/pay/notify 将域名修改为您的域名即可！",type:"success"})]),_:1}),e(I,{style:{margin:"20px"}},{header:a(()=>[U("div",z,[K,e(k,{class:"button",text:"",onClick:P},{default:a(()=>[g(" 保存设置 ")]),_:1})])]),default:a(()=>[e(q,{ref_key:"formRef",ref:d,rules:h.value,model:t,"label-width":"120px"},{default:a(()=>[e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"启用当前支付",prop:"payMpayPid"},{default:a(()=>[e(N,{modelValue:t.payMpayStatus,"onUpdate:modelValue":l[0]||(l[0]=p=>t.payMpayStatus=p),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"商户PID",prop:"payMpayPid"},{default:a(()=>[e(s,{modelValue:t.payMpayPid,"onUpdate:modelValue":l[1]||(l[1]=p=>t.payMpayPid=p),placeholder:"请填写商户PID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"商户秘钥",prop:"payMpaySecret"},{default:a(()=>[e(s,{modelValue:t.payMpaySecret,"onUpdate:modelValue":l[2]||(l[2]=p=>t.payMpaySecret=p),placeholder:"请填写商户秘钥",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付通知地址",prop:"payMpaySecret"},{default:a(()=>[e(s,{modelValue:t.payMpayNotifyUrl,"onUpdate:modelValue":l[3]||(l[3]=p=>t.payMpayNotifyUrl=p),placeholder:"请填写支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付回调地址",prop:"payMpaySecret"},{default:a(()=>[e(s,{modelValue:t.payMpayReturnUrl,"onUpdate:modelValue":l[4]||(l[4]=p=>t.payMpayReturnUrl=p),placeholder:"请填写支付成功后的回跳地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f),e(y,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(r,{label:"支付请求地址",prop:"payMpayApiPayUrl"},{default:a(()=>[e(s,{modelValue:t.payMpayApiPayUrl,"onUpdate:modelValue":l[5]||(l[5]=p=>t.payMpayApiPayUrl=p),placeholder:"请填写平台支付请求地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f),e(y,null,{default:a(()=>[e(u,{xs:24,md:24,lg:24,xl:24},{default:a(()=>[e(r,{label:"开启支付渠道",prop:"payMpayChannel"},{default:a(()=>[e(R,{modelValue:t.payMpayChannel,"onUpdate:modelValue":l[6]||(l[6]=p=>t.payMpayChannel=p),size:"small"},{default:a(()=>[(_(),M(B,null,E(C,p=>e(A,{key:p.value,border:"",label:p.value},{default:a(()=>[g(J(p.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof V=="function"&&V(F);export{F as default};
