import{d as H,r as u,O as b,y as P,c as s,Q,o as y,e as A,h as t,i as o,f as D,l as d,g as w,M as j,F as G,w as J,L as K,E as v,z as X,s as I}from"./index-a2cde0ca.js";import{a as g}from"./ai-6cfce3b8.js";import{I as Y}from"./index-97360b7c.js";import{W as Z}from"./index-f74fb548.js";const ee=["src"],te=H({__name:"aiCate",setup(ae){const S=u([]);Z.forEach(a=>{S.value.push({label:a.label.replaceAll("绘制",""),value:a.value})}),u(),u(0);const m=u(!1);b({rec:null,status:null,page:1,size:10});const V=u([]);async function p(){try{m.value=!0;const a=await g.list();m.value=!1,V.value=a.data}catch{m.value=!1}}const r=u(!1),C=u(),e=b({id:0,name:"",status:!1,sort:0,icon:""}),h=b({name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]}),N=async()=>{if(await C.value.validate(),e.icon==="")return v.error("请上传图片");if(e.id){await U({id:e.id,name:e.name,status:e.status?1:0,sort:e.sort,icon:e.icon});return}await g.add({name:e.name,status:e.status?1:0,sort:e.sort,icon:e.icon}),v.success("添加成功"),p(),k()},k=()=>{r.value=!1,e.name="",e.status=!1,e.sort=0},R="/api/upload/file",U=async a=>{await g.update({...a,status:a.status?1:0}),v.success("更新成功"),p()},T=async a=>{await U({...a})},$=a=>{e.name=a.name,e.status=a.status,e.sort=a.sort,e.id=a.id,a.icon&&(e.icon=a.icon),r.value=!0},q=async a=>{await g.del(a.id),v.success("删除成功"),p()};return P(()=>{p()}),(a,n)=>{const i=s("el-button"),B=s("el-input"),f=s("el-form-item"),x=s("el-switch"),E=s("el-input-number"),z=s("el-form"),F=s("el-dialog"),c=s("el-table-column"),M=s("el-popconfirm"),O=s("el-table"),W=X,L=Q("loading");return y(),A("div",null,[t(W,{style:{width:"100%"},class:"flex flex-col gap-2"},{default:o(()=>[D("div",null,[t(i,{type:"primary",onClick:n[0]||(n[0]=l=>r.value=!0)},{default:o(()=>[d("新增")]),_:1}),t(F,{title:e.id?"编辑":"新增",modelValue:w(r),"onUpdate:modelValue":n[6]||(n[6]=l=>j(r)?r.value=l:null),width:"30%","before-close":k},{footer:o(()=>[D("span",null,[t(i,{onClick:n[5]||(n[5]=l=>r.value=!1)},{default:o(()=>[d("取消")]),_:1}),t(i,{type:"primary",onClick:N},{default:o(()=>[d("确认")]),_:1})])]),default:o(()=>[t(z,{ref_key:"cateRef",ref:C,model:e,rules:h,"label-width":"auto",style:{"max-width":"600px"}},{default:o(()=>[t(f,{label:"分类名称",prop:"name"},{default:o(()=>[t(B,{modelValue:e.name,"onUpdate:modelValue":n[1]||(n[1]=l=>e.name=l)},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:o(()=>[t(x,{modelValue:e.status,"onUpdate:modelValue":n[2]||(n[2]=l=>e.status=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(f,{label:"排序",prop:"sort"},{default:o(()=>[t(E,{modelValue:e.sort,"onUpdate:modelValue":n[3]||(n[3]=l=>e.sort=l)},null,8,["modelValue"])]),_:1}),t(f,{label:"图片",prop:"icon"},{default:o(()=>[t(Y,{url:e.icon,"onUpdate:url":n[4]||(n[4]=l=>e.icon=l),action:R},{default:o(()=>[e.icon?(y(),A("img",{key:0,src:e.icon,style:{width:"50px"},class:"avatar"},null,8,ee)):G("",!0)]),_:1},8,["url"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])]),J((y(),K(O,{border:"",data:w(V),style:{width:"100%"},size:"large"},{default:o(()=>[t(c,{prop:"id",align:"center",label:"ID",width:"70"}),t(c,{prop:"name",align:"center",label:"分类名称"}),t(c,{prop:"status",align:"center",label:"状态"},{default:o(l=>[t(x,{modelValue:l.row.status,"onUpdate:modelValue":_=>l.row.status=_,onClick:_=>T(l.row),"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),t(c,{prop:"sort",align:"center",label:"排序"}),t(c,{prop:"userInfo",align:"center",label:"操作"},{default:o(l=>[t(i,{type:"primary",onClick:_=>$(l.row)},{default:o(()=>[d("编辑")]),_:2},1032,["onClick"]),t(M,{title:"确认删除吗?",onConfirm:_=>q(l.row)},{reference:o(()=>[t(i,{type:"danger"},{default:o(()=>[d("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[L,w(m)]])]),_:1})])}}});typeof I=="function"&&I(te);export{te as default};
