import{d as F,r,O as v,y as L,c as s,Q as H,o as D,e as P,h as t,i as l,f as A,l as c,g,M as Q,w as j,L as G,E as b,z as J,s as S}from"./index-a2cde0ca.js";import{D as f}from"./draw-6ac66bab.js";import{W as K}from"./index-f74fb548.js";const X=F({__name:"drawCate",setup(Y){const h=r([]);K.forEach(a=>{h.value.push({label:a.label.replaceAll("绘制",""),value:a.value})}),r(),r(0);const m=r(!1);v({rec:null,status:null,page:1,size:10});const w=r([]);async function p(){try{m.value=!0;const a=await f.list();m.value=!1,w.value=a.data}catch{m.value=!1}}const u=r(!1),y=r(),e=v({id:0,name:"",status:!1,sort:0}),R=v({name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]});async function T(){if(await y.value.validate(),e.id){await V({id:e.id,name:e.name,status:e.status?1:0,sort:e.sort});return}await f.add({name:e.name,status:e.status?1:0,sort:e.sort}),b.success("添加成功"),p(),C()}function C(){u.value=!1,e.name="",e.status=!1,e.sort=0}async function V(a){await f.update({...a,status:a.status?1:0}),b.success("更新成功"),p()}async function U(a){await V({...a})}function $(a){e.name=a.name,e.status=a.status===1,e.sort=a.sort,e.id=a.id,u.value=!0}async function q(a){await f.delete(a.id),b.success("删除成功"),p()}return L(()=>{p()}),(a,n)=>{const i=s("el-button"),B=s("el-input"),_=s("el-form-item"),k=s("el-switch"),E=s("el-input-number"),I=s("el-form"),N=s("el-dialog"),d=s("el-table-column"),z=s("el-popconfirm"),M=s("el-table"),O=J,W=H("loading");return D(),P("div",null,[t(O,{style:{width:"100%"},class:"flex flex-col gap-2"},{default:l(()=>[A("div",null,[t(i,{type:"primary",onClick:n[0]||(n[0]=o=>u.value=!0)},{default:l(()=>[c(" 新增 ")]),_:1}),t(N,{modelValue:g(u),"onUpdate:modelValue":n[5]||(n[5]=o=>Q(u)?u.value=o:null),title:e.id?"编辑":"新增",width:"30%","before-close":C},{footer:l(()=>[A("span",null,[t(i,{onClick:n[4]||(n[4]=o=>u.value=!1)},{default:l(()=>[c("取消")]),_:1}),t(i,{type:"primary",onClick:T},{default:l(()=>[c("确认")]),_:1})])]),default:l(()=>[t(I,{ref_key:"cateRef",ref:y,model:e,rules:R,"label-width":"auto",style:{"max-width":"600px"}},{default:l(()=>[t(_,{label:"分类名称",prop:"name"},{default:l(()=>[t(B,{modelValue:e.name,"onUpdate:modelValue":n[1]||(n[1]=o=>e.name=o)},null,8,["modelValue"])]),_:1}),t(_,{label:"状态",prop:"status"},{default:l(()=>[t(k,{"model-value":e.status,"onUpdate:modelValue":n[2]||(n[2]=o=>e.status=o)},null,8,["model-value"])]),_:1}),t(_,{label:"排序",prop:"sort"},{default:l(()=>[t(E,{modelValue:e.sort,"onUpdate:modelValue":n[3]||(n[3]=o=>e.sort=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),j((D(),G(M,{border:"",data:g(w),style:{width:"100%"},size:"large"},{default:l(()=>[t(d,{prop:"id",align:"center",label:"ID",width:"70"}),t(d,{prop:"name",align:"center",label:"分类名称"}),t(d,{prop:"status",align:"center",label:"状态"},{default:l(o=>[t(k,{"model-value":o.row.status,onClick:x=>U(o.row)},null,8,["model-value","onClick"])]),_:1}),t(d,{prop:"sort",align:"center",label:"排序"}),t(d,{prop:"userInfo",align:"center",label:"操作"},{default:l(o=>[t(i,{type:"primary",onClick:x=>$(o.row)},{default:l(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),t(z,{title:"确认删除吗?",onConfirm:x=>q(o.row)},{reference:l(()=>[t(i,{type:"danger"},{default:l(()=>[c(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,g(m)]])]),_:1})])}}});typeof S=="function"&&S(X);export{X as default};
