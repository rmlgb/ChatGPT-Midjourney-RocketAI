import{V,d as ae,O as z,r as _,I as oe,y as ne,c as n,Q as se,o as A,e as $,h as e,i as a,k as ue,m as re,J as pe,K as ie,L as Y,g as s,l as p,w as de,t as R,f as ce,M as me,E as k,S as _e,z as fe,s as q}from"./index-a2cde0ca.js";import{u as I}from"./utcformatTime-e76e5157.js";import{e as ye,Q as ge}from"./index-f74fb548.js";const C={queryAutoReply:i=>V.get("autoreply/query",{params:i}),delAutoReply:i=>V.post("autoreply/del",i),addAutoReply:i=>V.post("autoreply/add",i),updateAutoReply:i=>V.post("autoreply/update",i)},ve={class:"dialog-footer"},we=ae({__name:"autpReply",setup(i){const u=z({prompt:"",status:void 0,page:1,size:10}),c=_(!1),b=_(!1),g=_(0),S=_(0),U=_(),h=_(),r=z({status:0,prompt:"",answer:""}),N=z({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),T=_([]);async function d(){try{b.value=!0;const o=await C.queryAutoReply(u),{rows:l,count:v}=o.data;b.value=!1,S.value=v,T.value=l}catch{b.value=!1}}async function O(o){await C.delAutoReply({id:o}),k.success("删除自定义问题成功"),await d()}function P(o){o==null||o.resetFields(),d()}function B(o){g.value=o.id;const{status:l,prompt:v,answer:w}=o;c.value=!0,_e(()=>{Object.assign(r,{status:l,prompt:v,answer:w})})}const D=oe(()=>g.value!==0);function K(o){o==null||o.resetFields(),g.value=0}async function Q(o){o==null||o.validate(async l=>{if(!l)return k.warning("请按规则填写所有信息！");g.value===0?(await C.addAutoReply(r),k.success("添加自定义问题成功")):(await C.updateAutoReply({id:g.value,...r}),k.success("更新自定义问题成功")),c.value=!1,d()})}return ne(()=>{d()}),(o,l)=>{const v=n("el-alert"),w=fe,x=n("el-input"),f=n("el-form-item"),j=n("el-option"),F=n("el-select"),m=n("el-button"),L=n("Plus"),J=n("el-icon"),M=n("el-form"),y=n("el-table-column"),G=n("el-tag"),H=n("el-popconfirm"),W=n("el-table"),X=n("el-pagination"),Z=n("el-row"),E=n("el-switch"),ee=n("el-dialog"),te=se("loading");return A(),$("div",null,[e(w,null,{default:a(()=>[e(v,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"success"})]),_:1}),e(w,null,{default:a(()=>[e(M,{ref_key:"formRef",ref:U,inline:!0,model:u},{default:a(()=>[e(f,{label:"自定义问题",prop:"prompt"},{default:a(()=>[e(x,{modelValue:u.prompt,"onUpdate:modelValue":l[0]||(l[0]=t=>u.prompt=t),placeholder:"自定义问题[模糊搜索]",onKeydown:ue(re(d,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),e(f,{label:"问题启用状态",prop:"status"},{default:a(()=>[e(F,{modelValue:u.status,"onUpdate:modelValue":l[1]||(l[1]=t=>u.status=t),placeholder:"请选择问题启用状态",clearable:""},{default:a(()=>[(A(!0),$(pe,null,ie(s(ye),t=>(A(),Y(j,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(f,null,{default:a(()=>[e(m,{type:"primary",onClick:d},{default:a(()=>[p(" 查询 ")]),_:1}),e(m,{onClick:l[2]||(l[2]=t=>P(s(U)))},{default:a(()=>[p(" 重置 ")]),_:1})]),_:1}),e(m,{type:"success",style:{float:"right"},onClick:l[3]||(l[3]=t=>c.value=!0)},{default:a(()=>[p(" 添加新的自动回复 "),e(J,{class:"ml-3"},{default:a(()=>[e(L)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(w,{style:{width:"100%"}},{default:a(()=>[de((A(),Y(W,{border:"",data:s(T),style:{width:"100%"},size:"large"},{default:a(()=>[e(y,{prop:"prompt",label:"提问关键词"}),e(y,{prop:"answer",label:"回复答案"}),e(y,{prop:"status",label:"问题状态",width:"120"},{default:a(t=>[e(G,{type:t.row.status===1?"success":"daner"},{default:a(()=>[p(R(s(ge)[t.row.status]),1)]),_:2},1032,["type"])]),_:1}),e(y,{prop:"createdAt",label:"创建时间",width:"200"},{default:a(t=>[p(R(s(I)(t.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(y,{prop:"updatedAt",label:"最后修改时间",width:"200"},{default:a(t=>[p(R(s(I)(t.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(y,{fixed:"right",label:"操作",width:"200"},{default:a(t=>[e(m,{link:"",type:"primary",size:"small",onClick:le=>B(t.row)},{default:a(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(H,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:le=>O(t.row.id)},{reference:a(()=>[e(m,{link:"",type:"danger",size:"small"},{default:a(()=>[p(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,s(b)]]),e(Z,{class:"flex justify-end mt-5"},{default:a(()=>[e(X,{"current-page":u.page,"onUpdate:currentPage":l[4]||(l[4]=t=>u.page=t),"page-size":u.size,"onUpdate:pageSize":l[5]||(l[5]=t=>u.size=t),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:s(S),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(ee,{modelValue:s(c),"onUpdate:modelValue":l[11]||(l[11]=t=>me(c)?c.value=t:null),title:`${s(D)?"编辑":"添加"}自动回复问题`,width:"480",onClose:l[12]||(l[12]=t=>K(s(h)))},{footer:a(()=>[ce("span",ve,[e(m,{onClick:l[9]||(l[9]=t=>c.value=!1)},{default:a(()=>[p("放弃生成")]),_:1}),e(m,{type:"primary",onClick:l[10]||(l[10]=t=>Q(s(h)))},{default:a(()=>[p(R(`${s(D)?"更新":"新增"}回复 `),1)]),_:1})])]),default:a(()=>[e(M,{ref_key:"formAutoReplyRef",ref:h,"label-position":"right","label-width":"80px",model:r,rules:N},{default:a(()=>[e(f,{label:"开启状态",prop:"status"},{default:a(()=>[e(E,{modelValue:r.status,"onUpdate:modelValue":l[6]||(l[6]=t=>r.status=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(f,{label:"提问问题",prop:"prompt"},{default:a(()=>[e(x,{modelValue:r.prompt,"onUpdate:modelValue":l[7]||(l[7]=t=>r.prompt=t),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])]),_:1}),e(f,{label:"回复问题",prop:"answer"},{default:a(()=>[e(x,{modelValue:r.answer,"onUpdate:modelValue":l[8]||(l[8]=t=>r.answer=t),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof q=="function"&&q(we);export{we as default};
