import{d as a,b as e,L as l,a as t,aZ as s,v as i,o as p,c as n,e as o,t as c,h as u,g as r,w as v,m as d,f,y as m,C as x,ap as g,b$ as y,l as w,z as I,c0 as h,_,x as A,K as b,r as k,O as C,A as j,N as L,av as M,n as S,F as R,j as U,ai as z,b4 as E,c1 as F,c2 as H}from"./index-62750275.js";import{_ as N}from"./appCard.vue_vue_type_script_setup_true_lang-8ad03fcd.js";import{u as P}from"./useLoading-9b5f86c7.js";import{_ as q}from"./WishLayoutSilder.vue_vue_type_script_setup_true_lang-983a17ef.js";import{_ as B}from"./WishDrivider.vue_vue_type_script_setup_true_lang-40c45d59.js";import{_ as T,a as D}from"./DrawerContent-404be8e8.js";import{_ as G}from"./Dropdown-0073002d.js";import{_ as $,a as K}from"./Grid-f8a825d9.js";import"./Ellipsis-e9b4b389.js";import"./Popconfirm-b5167f80.js";const W={key:0,class:"flex flex-col w-[95%] m-auto items-center gap-[8px] relative pt-[85px]"},O={class:"absolute top-[-45px] blur-[40px]"},Z=["src"],J={class:"h-[70px] w-[70px] rounded-[50%] bg-[#F0F0F0] overflow-hidden flex justify-center items-center"},Q=["src"],V={class:"font-bold text-[22px]"},X={class:"flex gap-[8px]"},Y={key:0,class:"flex items-center text-[12px] text-[#666666] font-bold bg-[#89eca7] dark:bg-[#97FE76] primaryRadius px-[8px] py-[2px] gap-[2px] cursor-pointer"},aa={key:1,class:"flex items-center text-[12px] text-[#666666] bg-[#E9E9E9] dark:bg-[#080707] primaryRadius px-[8px] py-[2px] gap-[2px] cursor-pointer"},ea=["src"],la={key:0,class:""},ta={class:"text-[#666666]"},sa={class:"flex flex-col gap-[15px] w-full pt-[15px]"},ia=_(a({__name:"appInfoShowCard",props:{activeAppInfo:{}},emits:["handleRunApp","handleCollect","update:activeAppInfo"],setup(a,{emit:_}){const A=e(),b=l(),{isSmallLg:k}=t(),C=s(),j=a,L=_,M=i((()=>C.mineApps)),S=i((()=>(console.log("mineApps",M.value),M.value.find((a=>a.appId==j.activeAppInfo.id)))));async function R(a){if(U(a)){R((await y(a)).data)}else{const e=await g(),{modelMaps:l}=e.data;if(!l[1])return A.warning("管理员未配置特定应用模型、请联系管理员配置~");b.push({path:"/chat",query:{appId:a.id}})}}const U=a=>"description"in a;return(a,e)=>{const l=w,t=I,s=w,i=B;return a.activeAppInfo?(p(),n("div",W,[o("div",O,[o("img",{class:"w-[65px] h-[65px]",draggable:"false",src:U(a.activeAppInfo)?a.activeAppInfo.favicon:a.activeAppInfo.coverImg,alt:""},null,8,Z)]),o("div",J,[o("img",{class:"h-[50px] w-[50px]",draggable:"false",src:U(a.activeAppInfo)?a.activeAppInfo.favicon:a.activeAppInfo.coverImg,alt:""},null,8,Q)]),o("span",V,c(U(a.activeAppInfo)?a.activeAppInfo.title:a.activeAppInfo.name),1),o("div",X,[U(a.activeAppInfo)?(p(),n("div",Y," GPTS ")):u("",!0),!U(a.activeAppInfo)&&a.activeAppInfo.catId?(p(),n("div",aa,[o("img",{class:"w-[17px] h-[17px]",src:U(a.activeAppInfo)?a.activeAppInfo.favicon:a.activeAppInfo.catImg,alt:""},null,8,ea),U(a.activeAppInfo)?u("",!0):(p(),n("span",la,c(a.activeAppInfo.catName),1))])):u("",!0)]),o("span",ta,c(U(a.activeAppInfo)?a.activeAppInfo.description:a.activeAppInfo.des),1),o("div",sa,[r(l,{size:f(k)?"tiny":"small",type:"primary",onClick:e[0]||(e[0]=e=>R(a.activeAppInfo))},{default:v((()=>[d("添加助手并会话")])),_:1},8,["size"]),U(a.activeAppInfo)?u("",!0):(p(),m(s,{key:0,class:"!w-[full]",size:f(k)?"tiny":"small",ghost:"",onClick:e[1]||(e[1]=x((e=>async function(a){if(U(a)){const e=await y(a);L("update:activeAppInfo",e.data),await C.queryMineApps()}else{a.loading=!0;try{const e=await h({appId:a.id});A.success(e.data),await C.queryMineApps(),a.loading=!1}catch(e){a.loading=!1}}}(a.activeAppInfo)),["stop"]))},{icon:v((()=>[r(t,{icon:f(S)?"iconamoon:sign-minus-bold":"mi:add",class:"text-base"},null,8,["icon"])])),default:v((()=>[d(" "+c(f(S)?"取消收藏":"添加助手"),1)])),_:1},8,["size"]))]),r(i)])):u("",!0)}}}),[["__scopeId","data-v-39f9322a"]]),pa={class:"!w-full primaryRadius bg-[white] dark:bg-[#101014] p-4"},na={class:"relative w-full overflow-hidden"},oa=["innerHTML"],ca={class:"flex items-center gap-2 h-[40px] pt-[20px] w-full justify-between"},ua={class:"flex items-center justify-center"},ra={class:"flex flex-wrap relative w-full mt-[15px] py-[10px]"},va={key:0,class:"w-full h-full flex flex-wrap gap-[10px]"},da=["onClick"],fa={class:"flex items-center gap-2"},ma=["src"],xa={class:"flex flex-col"},ga=o("div",{class:"flex"},null,-1),ya={class:"grid row-[3] max-w-[1550px] m-auto"},wa=a({__name:"index",emits:["run-app"],setup(a,{emit:d}){var x;const{winHeight:g}=A(),{isMobile:y,isSmallLg:h}=t(),_=b();null==(x=_.globalConfig)||x.siteRobotName;const B=i((()=>_.globalConfig));i((()=>_.globalConfig.appMenuHeaderTips)),i((()=>_.globalConfig.appMenuHeaderBgUrl)),l(),e();const W=s(),O=k(""),Z=k([]),J=i((()=>W.catId)),Q=k([]),V=k([]);i((()=>W.mineApps));const X=k([]),Y=k(0);const aa=i((()=>{let a=[];return a=Q.value.filter((a=>a.catId===Y.value)),O.value&&(a=Q.value.filter((a=>a.name.includes(O.value)))),0===Y.value&&(a=Q.value),a.map((a=>{const e=X.value.find((e=>e.id==a.catId));return{...a,catImg:null==e?void 0:e.coverImg}}))}));const ea=i((()=>0==ba.value?aa.value.filter((a=>a.name.includes(O.value))):la.value)),la=k([]),{startLoading:ta,closeLoading:sa}=P(),wa=async()=>{if(0!=ba.value){ta("搜索中...");try{const a=await F(O.value);la.value=a.data.data,sa("success","搜索成功!")}catch(a){sa("error","搜索失败!")}}};C(J,(a=>{V.value=a?Q.value.filter((e=>e.catId===a)):Q.value})),j((async()=>{await async function(){var a;const e=await E();X.value=[{id:0,name:"全部分类"},...null==(a=null==e?void 0:e.data)?void 0:a.rows],console.log("分类catList",X.value)}(),await async function(){var a;const e=await z(),l=null==(a=null==e?void 0:e.data)?void 0:a.rows.map((a=>(a.loading=!1,a)));V.value=Q.value;const t=[];l.forEach((a=>{const e=X.value.find((e=>e.id==a.catId));t.push({...a,catImg:null==e?void 0:e.coverImg})})),Q.value=t,console.log("appList",Q.value)}(),await async function(){const a=await H({menuPlatform:1});a.success&&(Z.value=a.data)}()}));const Ia=k(!0),ha=k(!1),_a=i((()=>{const a=!Aa.value;return(y.value||h.value)&&(ha.value=!a),Ia.value=!!a,a})),Aa=k();C((()=>Ia.value),(a=>{a&&(Aa.value=void 0)}));const ba=k(0),ka=a=>{ba.value=Number(a)};return(a,e)=>{const l=T,t=D,s=G,i=$,d=K;return p(),n(R,null,[r(t,{placement:"bottom",show:ha.value,"onUpdate:show":e[1]||(e[1]=a=>ha.value=a),height:f(g)-100},{default:v((()=>[Aa.value?(p(),m(l,{key:0,closable:""},{footer:v((()=>[])),default:v((()=>[Aa.value?(p(),m(ia,{key:0,"active-app-info":Aa.value,"onUpdate:activeAppInfo":e[0]||(e[0]=a=>Aa.value=a)},null,8,["active-app-info"])):u("",!0)])),_:1})):u("",!0)])),_:1},8,["show","height"]),r(q,{hideSliderBtn:_a.value,collapsed:Ia.value,"onUpdate:collapsed":e[5]||(e[5]=a=>Ia.value=a),sliderPlacement:"right"},{slider:v((()=>[Aa.value?(p(),m(ia,{key:0,"active-app-info":Aa.value,"onUpdate:activeAppInfo":e[2]||(e[2]=a=>Aa.value=a)},null,8,["active-app-info"])):u("",!0)])),content:v((()=>[o("div",{class:S(["h-full m-auto",`${f(y)?" py-4 px-0":" p-4"} ${f(h)?"w-[100%]":"w-[1140px]"}`])},[o("div",pa,[o("div",na,[o("div",{innerHTML:B.value.appNoticeInfo},null,8,oa)]),o("div",ca,[r(f(L),{onKeydown:M(wa,["enter"]),value:O.value,"onUpdate:value":e[3]||(e[3]=a=>O.value=a),placeholder:0==ba.value?"搜索应用名称、快速查找应用...":"回车搜索网络应用名称、快速查找应用...",class:"!w-full"},{prefix:v((()=>[r(f(I),{icon:"iconamoon:search-thin"})])),_:1},8,["value","placeholder"]),r(s,{size:"large",trigger:"hover",value:ba.value,"onUpdate:value":e[4]||(e[4]=a=>ba.value=a),onSelect:ka,options:[{label:"站内搜索",key:0},{label:"全网搜索",key:1}]},{default:v((()=>[r(f(w),{onClick:wa,class:S(["",""+(f(y),"!w-[100px]")]),type:"primary"},{default:v((()=>[o("div",ua,[o("span",null,c(0==ba.value?"站内":"网络")+"搜索",1),r(f(I),{class:"text-[30px]",icon:"mingcute:down-small-line"})])])),_:1},8,["class"])])),_:1},8,["value"])]),o("div",ra,[ba.value?u("",!0):(p(),n("div",va,[(p(!0),n(R,null,U(X.value,((a,e)=>(p(),n("div",{class:S(["primaryRadius px-[15px] py-[5px] text-[13px] cursor-pointer border border-[#dddddd] dark:border-[#474646] relative",{"bg-[#222222] text-[#fff] dark:bg-[#fff] dark:text-[#000] ":Y.value===a.id,"bg-[#fff] text-[#000] dark:bg-[#000] dark:text-[#fff]":Y.value!==a.id}]),key:e,onClick:e=>{return l=a.id,void(Y.value=l);var l}},[o("div",fa,[a.coverImg?(p(),n("img",{key:0,src:a.coverImg,class:"w-[14px] h-[14px]"},null,8,ma)):u("",!0),o("div",xa,[o("span",null,c(a.name),1),ga])])],10,da)))),128))]))]),o("div",ya,[r(d,{"item-responsive":"",cols:"2 s:3 m:2 l:2 xl:3 2xl:3","x-gap":"15px","y-gap":"15px",responsive:"screen"},{default:v((()=>[(p(!0),n(R,null,U(ea.value,(a=>(p(),m(i,{onClick:e=>Aa.value=a,key:a.id},{default:v((()=>[r(N,{type:"app",item:a},null,8,["item"])])),_:2},1032,["onClick"])))),128))])),_:1})])])],2)])),_:1},8,["hideSliderBtn","collapsed"])],64)}}}),Ia={class:"w-full h-full"},ha=a({__name:"index",setup(a){const e=k({}),l=s();function t(a){e.value=a}return j((async()=>{!l.mineApps.length&&await l.queryMineApps()})),(a,e)=>(p(),n("div",Ia,[r(wa,{onRunApp:t})]))}});export{ha as default};
